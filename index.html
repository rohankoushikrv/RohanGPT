<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RohanGPT</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"/>
</head>
<body class="bg-black text-white p-6">
  <div id="root" class="max-w-3xl mx-auto"></div>

  <script type="text/javascript">
    const { useState } = React;

    const ChatApp = () => {
      const [messages, setMessages] = useState([]);
      const [input, setInput] = useState('');
      const [isLoading, setIsLoading] = useState(false);

      const fetchResponse = async (userInput) => {
        setIsLoading(true);
        try {
          const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
            method: 'POST',
            headers: {
              'Authorization': 'Bearer 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', // ← replace with your key
              'Content-Type': 'application/json',
              'HTTP-Referer': 'https://rohankoushikrv.github.io/RohanGPT/', // ← replace with your GitHub Pages URL if needed
              'X-Title': 'RohanGPT'
            },
            body: JSON.stringify({
              model: 'openrouter:meta-llama/Meta-Llama-3-8B-Instruct',
              messages: [
                { role: 'user', content: userInput }
              ]
            })
          });

          const data = await response.json();
          console.log('API response:', data);
          return data?.choices?.[0]?.message?.content || '⚠️ No response.';
        } catch (error) {
          console.error('Error:', error);
          return '⚠️ Error: ' + error.message;
        } finally {
          setIsLoading(false);
        }
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        if (!input.trim()) return;

        const userMessage = { role: 'user', content: input };
        setMessages([...messages, userMessage]);
        setInput('');

        const reply = await fetchResponse(input);
        setMessages((prev) => [...prev, { role: 'bot', content: reply }]);
      };

      return React.createElement('div', { className: 'bg-gray-900 rounded-xl p-6 border border-gray-700' },
        React.createElement('h1', { className: 'text-3xl font-bold mb-4 text-center' }, 'RohanGPT'),

        React.createElement('div', { className: 'h-80 overflow-y-auto mb-4 space-y-3' },
          messages.map((msg, index) =>
            React.createElement('div', {
              key: index,
              className: `p-3 rounded-lg ${msg.role === 'user' ? 'bg-blue-600 text-white text-right' : 'bg-gray-700 text-left'}`
            }, msg.content)
          ),
          isLoading && React.createElement('div', { className: 'italic text-gray-400' }, 'Bot is typing...')
        ),

        React.createElement('form', { onSubmit: handleSubmit, className: 'flex gap-3' },
          React.createElement('input', {
            className: 'flex-1 p-3 rounded-lg bg-gray-800 text-white border border-gray-600',
            type: 'text',
            value: input,
            placeholder: 'Type your message...',
            onChange: (e) => setInput(e.target.value),
            disabled: isLoading
          }),
          React.createElement('button', {
            type: 'submit',
            className: 'bg-blue-600 text-white px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50',
            disabled: isLoading
          }, 'Send')
        )
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(ChatApp));
  </script>
</body>
</html>
